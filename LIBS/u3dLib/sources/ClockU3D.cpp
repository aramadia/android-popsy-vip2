    				 /*-----------------------------------------------------+
					  |				         ClockU3D.cpp					|
					  |														|
					  |	   Une classe ki permet d'avoir un timer un temps	|
					  |			 soit peu + precis ke le clock()			|
					  |														|
					  | 	U2^PoPsy TeAm 2000								|
					  +-----------------------------------------------------*/

#include "U3D3.h"

//----------------------------------------------------------------------------------------------------------
////////////////////////////////////////////////////////////////////////////////////////////////////////////
//									+-------------------------+
//									|   Variables Globales	  |
//									+-------------------------+
////////////////////////////////////////////////////////////////////////////////////////////////////////////
//----------------------------------------------------------------------------------------------------------



//----------------------------------------------------------------------------------------------------------
////////////////////////////////////////////////////////////////////////////////////////////////////////////
//									+---------------------+
//									|    Class ClockU3D	  |
//									+---------------------+
////////////////////////////////////////////////////////////////////////////////////////////////////////////
//----------------------------------------------------------------------------------------------------------

struct timeval ClockU3D::start;
double ClockU3D::extra_adj = 0.0;
double ClockU3D::mp3_timer = -1.0;

void ClockU3D::Initialise()
{
	gettimeofday(&start, NULL);
	extra_adj = 0.0;
}
void ClockU3D::Reset()
{
	Initialise();
}
//----------------------------------------------------------------------------------------------------------
double ClockU3D::GetTime()
{
	if (mp3_timer != -1.0) {
		return mp3_timer + extra_adj;
	}
	
	struct timeval now;
	
	gettimeofday(&now, NULL);

	return 
	 	 (now.tv_sec - start.tv_sec) +
                 (double)(now.tv_usec - start.tv_usec) * 0.000001f + extra_adj;
}
//----------------------------------------------------------------------------------------------------------
